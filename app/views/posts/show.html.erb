<div class="max-w-3xl mx-auto">
    <% if @post.image.attached? %>
    <div class="mb-8 rounded-xl overflow-hidden">
        <%= image_tag @post.image, class: "w-full h-64 object-cover" %>
    </div>
    <% end %>

    <div class="bg-white rounded-xl shadow-md p-8 mb-6">
        <div class="flex items-center justify-between mb-4">
            <span class="bg-<%= @post.public? ? 'green' : 'blue' %>-100 text-<%= @post.public? ? 'green' : 'blue' %>-800 text-xs font-medium px-2.5 py-0.5 rounded">
                <%= @post.public? ? 'Public' : 'Private' %>
            </span>

            <div class="text-sm text-gray-500">
                <%= time_ago_in_words(@post.created_at) %> ago
            </div>
        </div>

        <h1 class="text-3xl font-bold text-gray-800 mb-4"><%= @post.title %></h1>

        <div class="prose max-w-none mb-8">
            <div class="text-gray-700 leading-relaxed">
                <%= raw @post.description %>
            </div>
        </div>

        <!-- Q&A Section -->
        <% if @post.questions.present? && @post.answers.present? %>
        <div x-data="{ open: false }" class="mb-6">
            <button @click="open = !open" class="w-full flex justify-between items-center bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium px-4 py-2 rounded-lg focus:outline-none">
                <span>Questions & Answers</span>
                <svg :class="{'rotate-180': open}" class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </button>

            <div x-show="open" x-transition class="mt-4 space-y-4 border-l-4 border-blue-500 pl-4">
                <% @post.questions.each_with_index do |q, idx| %>
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
                    <p class="font-semibold text-gray-700">Q<%= idx + 1 %>: <%= q %></p>
                    <p class="mt-2 text-gray-600">A: <%= @post.answers[idx] %></p>
                </div>
                <% end %>
            </div>
        </div>
        <% end %>
        <!-- End Q&A Section -->

        <!-- End Q&A Section -->

        <div class="flex items-center border-t border-gray-100 pt-6">
            <div class="h-10 w-10 rounded-full gradient-bg flex items-center justify-center text-white font-medium">
                <%= @post.user.email[0].upcase %>
            </div>
            <div class="ml-3">
                <p class="text-sm font-medium text-gray-900"><%= @post.user.email %></p>
            </div>

            <% if user_signed_in? && current_user == @post.user %>
            <div class="ml-auto flex space-x-2">
                <%= link_to edit_post_path(@post), class: "text-gray-600 hover:text-gray-900 px-3 py-1 rounded-md text-sm font-medium flex items-center" do %>
                <i class="fas fa-edit mr-1"></i> Edit
                <% end %>
                <%= link_to @post,
              data: { turbo_method: :delete, turbo_confirm: "Are you sure?" },
              class: "text-red-600 hover:text-red-900 px-3 py-1 rounded-md text-sm font-medium flex items-center" do %>
                <i class="fas fa-trash mr-1"></i> Delete
                <% end %>
            </div>
            <% end %>
        </div>
    </div>

    <div class="flex justify-between">
        <%= link_to posts_path, class: "text-blue-600 hover:text-blue-800 font-medium flex items-center" do %>
        <i class="fas fa-arrow-left mr-2"></i> Back to all posts
        <% end %>

        <% if user_signed_in? && current_user == @post.user %>
        <%= link_to dashboard_path, class: "text-gray-600 hover:text-gray-900 font-medium flex items-center" do %>
        <i class="fas fa-th-large mr-2"></i> Dashboard
        <% end %>
        <% end %>
    </div>
</div>